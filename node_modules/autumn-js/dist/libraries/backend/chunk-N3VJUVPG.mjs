import {
  withAuth
} from "./chunk-RN3IUPE5.mjs";
import {
  BASE_PATH
} from "./chunk-KSG3E4Q2.mjs";

// src/libraries/backend/routes/genRoutes.ts
import { addRoute } from "rou3";
var sanitizeBody = (body) => {
  const bodyCopy = { ...body };
  delete bodyCopy.customer_id;
  delete bodyCopy.customer_data;
  return bodyCopy;
};
var checkoutHandler = withAuth({
  fn: async ({
    autumn,
    customer_id,
    customer_data,
    body
  }) => {
    const result = await autumn.checkout({
      ...sanitizeBody(body),
      customer_id,
      customer_data
    });
    return result;
  }
});
var attachHandler = withAuth({
  fn: async ({
    autumn,
    customer_id,
    customer_data,
    body
  }) => {
    console.log("Body: ", body);
    console.log("Customer ID: ", customer_id);
    return await autumn.attach({
      ...sanitizeBody(body),
      customer_id,
      customer_data
    });
  }
});
var setupPaymentHandler = withAuth({
  fn: async ({
    autumn,
    customer_id,
    customer_data,
    body
  }) => {
    return await autumn.setupPayment({
      ...sanitizeBody(body),
      customer_id,
      customer_data
    });
  }
});
var cancelHandler = withAuth({
  fn: async ({
    autumn,
    customer_id,
    body
  }) => {
    return await autumn.cancel({
      ...sanitizeBody(body),
      customer_id
    });
  }
});
var checkHandler = withAuth({
  fn: async ({
    autumn,
    customer_id,
    customer_data,
    body
  }) => {
    const result = await autumn.check({
      ...sanitizeBody(body),
      customer_id,
      customer_data
    });
    return result;
  }
});
var trackHandler = withAuth({
  fn: async ({
    autumn,
    customer_id,
    customer_data,
    body
  }) => {
    return await autumn.track({
      ...sanitizeBody(body),
      customer_id,
      customer_data
    });
  }
});
var openBillingPortalHandler = withAuth({
  fn: async ({
    autumn,
    customer_id,
    body
  }) => {
    return await autumn.customers.billingPortal(customer_id, body);
  }
});
var queryHandler = withAuth({
  fn: async ({
    autumn,
    customer_id,
    body
  }) => {
    return await autumn.query({
      ...sanitizeBody(body),
      customer_id
    });
  }
});
var addGenRoutes = (router) => {
  addRoute(router, "POST", `${BASE_PATH}/checkout`, {
    handler: checkoutHandler
  });
  addRoute(router, "POST", `${BASE_PATH}/attach`, {
    handler: attachHandler
  });
  addRoute(router, "POST", `${BASE_PATH}/cancel`, {
    handler: cancelHandler
  });
  addRoute(router, "POST", `${BASE_PATH}/check`, {
    handler: checkHandler
  });
  addRoute(router, "POST", `${BASE_PATH}/track`, {
    handler: trackHandler
  });
  addRoute(router, "POST", `${BASE_PATH}/billing_portal`, {
    handler: openBillingPortalHandler
  });
  addRoute(router, "POST", `${BASE_PATH}/setup_payment`, {
    handler: setupPaymentHandler
  });
  addRoute(router, "POST", `${BASE_PATH}/query`, {
    handler: queryHandler
  });
};

export {
  addGenRoutes
};
